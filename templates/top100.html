<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Top-100 PXP</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<style>
  .page { max-width: 1100px; margin: 0 auto; padding: 20px; }

  h1 { margin-bottom: 18px; color: var(--ink); }

  .table {
    width: 100%;
    border-collapse: collapse;
    border-radius: 12px;
    overflow: hidden;
    background: color-mix(in srgb, var(--card) 96%, #000 4%);
    box-shadow: 0 8px 24px rgba(0,0,0,.25);
  }

  .table th, .table td {
    padding: 12px 14px;
    text-align: left;
    border-top: 1px solid var(--line);
    color: var(--ink);
  }

  .table th {
    background: color-mix(in srgb, var(--card) 90%, #000 10%);
    font-weight: 700;
    color: var(--muted);
  }

  .table tr:nth-child(even) {
    background: color-mix(in srgb, var(--card) 92%, #000 8%);
  }

  .table tr:hover {
    background: color-mix(in srgb, var(--btn-bg) 15%, var(--card) 85%);
  }

  .rank {
    font-weight: 700;
    color: var(--btn-bg);
  }

  .pxp {
    font-weight: 600;
    color: var(--btn-text-hover);
  }
</style>

</head>
<body>
  {% include 'nav.html' %}

  <div class="page">
    <h1>Top-100 PXP</h1>
    <div class="sub">–†–µ–π—Ç–∏–Ω–≥ –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é <b>PXP</b>. –û–±–µ—Ä–∏ –ø–µ—Ä—ñ–æ–¥.</div>

    <div class="panel" id="heroPanel" style="display:none; margin-bottom:14px;">
      <div class="hero">
        <div id="heroAva" class="ava"></div>
        <div class="meta">
          <div class="name" id="heroName">‚Äî</div>
          <div class="stats">
            <span id="heroPxp">PXP: ‚Äî</span>
            <span id="heroDate">–ó –Ω–∞–º–∏ –∑: ‚Äî</span>
          </div>
        </div>
        <a id="heroBtn" href="{{ url_for('profile.profile') }}" class="btn">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å</a>
        <div class="badge"><span class="medal">ü•á</span> –¢–æ–ø-1</div>
      </div>
    </div>

    <div class="panel">
      <div class="toolbar" style="display:flex; gap:8px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:12px;">
        <div class="tabs" id="tabs" style="display:flex; gap:8px;">
          <button class="tab active" data-range="all" style="padding:8px 12px; border-radius:10px; background:#1a1f2e; border:1px solid #25304b; cursor:pointer; font-weight:600;">–ó–∞ –≤–µ—Å—å —á–∞—Å</button>
          <button class="tab" data-range="month" style="padding:8px 12px; border-radius:10px; background:#1a1f2e; border:1px solid #25304b; cursor:pointer; font-weight:600;">–ú—ñ—Å—è—Ü—å</button>
          <button class="tab" data-range="week" style="padding:8px 12px; border-radius:10px; background:#1a1f2e; border:1px solid #25304b; cursor:pointer; font-weight:600;">–¢–∏–∂–¥–µ–Ω—å</button>
        </div>
        <div class="sub">PXP = PixPaw üêæ</div>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr><th class="rank">#</th><th>–ù—ñ–∫</th><th>PXP</th><th>–ó –Ω–∞–º–∏ –∑</th></tr>
          </thead>
          <tbody id="tbody">
            <tr class="sk-row"><td><div class="skeleton sk-b"></div></td><td><div style="display:flex;align-items:center;gap:10px;"><div class="sk-a"></div><div class="skeleton sk-n"></div></div></td><td><div class="skeleton sk-b"></div></td><td><div class="skeleton sk-l"></div></td></tr>
            <tr class="sk-row"><td><div class="skeleton sk-b"></div></td><td><div style="display:flex;align-items:center;gap:10px;"><div class="sk-a"></div><div class="skeleton sk-n"></div></div></td><td><div class="skeleton sk-b"></div></td><td><div class="skeleton sk-l"></div></td></tr>
            <tr class="sk-row"><td><div class="skeleton sk-b"></div></td><td><div style="display:flex;align-items:center;gap:10px;"><div class="sk-a"></div><div class="skeleton sk-n"></div></div></td><td><div class="skeleton sk-b"></div></td><td><div class="skeleton sk-l"></div></td></tr>
          </tbody>
        </table>
      </div>

      <div id="myrank" class="note" style="margin-top:12px"></div>
      <div class="note">–©–æ–± —É–≤—ñ–π—Ç–∏ –¥–æ –¢–û–ü-100, –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ –±—ñ–ª—å—à–µ PXP, –Ω—ñ–∂ —É 100-–≥–æ –º—ñ—Å—Ü—è. 1$ = 1 PXP.</div>
    </div>
  </div>

  <script>
    const API = '/api/pxp/top100';

    function formatSince(dateStr) {
      // —è–∫—â–æ –∫–æ–ª–∏—Å—å –¥–æ–¥–∞—Å–∏ –ø–æ–ª–µ "created_at" ‚Äî —Ç—É—Ç –π–æ–≥–æ –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç—É–π.
      return '‚Äî';
    }

    function renderRows(list) {
      const tbody = document.getElementById('tbody');
      tbody.innerHTML = '';
      if (!list.length) {
        tbody.innerHTML = `<tr><td colspan="4" class="sub">–©–µ –Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö</td></tr>`;
        return;
      }
      list.forEach((u, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="rank">${i + 1}</td>
          <td>
            <div style="display:flex;align-items:center;gap:10px;">
              <div class="ava" style="width:36px;height:36px;border-radius:10px;"></div>
              <span>${u.name || '–ë–µ–∑ —ñ–º–µ–Ω—ñ'}</span>
            </div>
          </td>
          <td>${u.pxp}</td>
          <td>${formatSince(u.created_at)}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function renderHero(list) {
      if (!list.length) return;
      const top = list[0];
      document.getElementById('heroName').textContent = top.name || '–ë–µ–∑ —ñ–º–µ–Ω—ñ';
      document.getElementById('heroPxp').textContent  = `PXP: ${top.pxp}`;
      document.getElementById('heroDate').textContent = `–ó –Ω–∞–º–∏ –∑: ${formatSince(top.created_at)}`;
      document.getElementById('heroPanel').style.display = 'block';
    }

    document.addEventListener('DOMContentLoaded', () => {
      fetch(API)
        .then(r => r.json())
        .then(data => {
          renderRows(data);
          renderHero(data);
        })
        .catch(err => {
          console.error(err);
          const tbody = document.getElementById('tbody');
          tbody.innerHTML = `<tr><td colspan="4">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</td></tr>`;
        });
    });
  </script>
</body>
</html>

