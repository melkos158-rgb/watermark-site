{% set cats = g.market_categories if g.market_categories is defined and g.market_categories else [] %}
<div class="filters">
  <div class="cat-tags">
    <button class="tag-btn active" data-cat="">{{ _('–£—Å—ñ') }}</button>
    {% for c in cats %}
      <button class="tag-btn" data-cat="{{ c.slug }}">{{ c.name }}</button>
    {% endfor %}
  </div>

  <div class="sort-wrap">
    <label>
      <span>{{ _('–°–æ—Ä—Ç—É–≤–∞—Ç–∏') }}</span>
      {% set cur = request.args.get('sort','new') %}
      <select id="sort" data-filter-sort>
        <option value="new"       {{ 'selected' if cur=='new' }}>–ù–æ–≤—ñ</option>
        <option value="popular"   {{ 'selected' if cur=='popular' }}>–ü–æ–ø—É–ª—è—Ä–Ω—ñ</option>
        <option value="rating"    {{ 'selected' if cur=='rating' }}>–†–µ–π—Ç–∏–Ω–≥</option>
        <option value="prints"    {{ 'selected' if cur=='prints' }}>Top prints (–≤—Å—ñ)</option>
        <option value="prints_7d" {{ 'selected' if cur=='prints_7d' }}>üî• Trending 7d</option>
        <option value="prints_30d" {{ 'selected' if cur=='prints_30d' }}>üìà Trending 30d</option>
        <option value="price"     {{ 'selected' if cur=='price' }}>–¶—ñ–Ω–∞</option>
      </select>
    </label>
    <a href="/market/top-prints" class="tag-btn top-prints-btn" title="–ú–æ–¥–µ–ª—ñ –∑ –Ω–∞–π–±—ñ–ª—å—à–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ä–æ–∑–¥—Ä—É–∫—É–≤–∞–Ω—å">
      üñ®Ô∏è Top Prints
    </a>
  </div>
</div>

<style>
.filters{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-bottom:10px;
}

.cat-tags{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.tag-btn{
  background:var(--card);
  border:1px solid var(--line);
  color:var(--text);
  border-radius:20px;
  padding:5px 12px;
  font-size:13px;
  cursor:pointer;
  transition:all .2s;
}
.tag-btn:hover{background:var(--accent);color:#fff;}
.tag-btn.active{background:var(--accent);color:#fff;box-shadow:0 0 10px rgba(59,130,246,.5);}

.sort-wrap{
  display:flex;
  align-items:center;
  gap:6px;
  flex-wrap:wrap;
}
.sort-wrap span{color:var(--muted);font-size:.95em;}
.sort-wrap select{
  background:var(--card);
  border:1px solid var(--line);
  color:var(--text);
  border-radius:8px;
  padding:6px 10px;
}
.top-prints-btn{
  background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color:#fff;
  font-weight:600;
  box-shadow:0 2px 8px rgba(102,126,234,.3);
  text-decoration:none;
}
.top-prints-btn:hover{
  background:linear-gradient(135deg, #764ba2 0%, #667eea 100%);
  box-shadow:0 4px 12px rgba(102,126,234,.5);
  transform:translateY(-1px);
}
</style>

<script>
  document.addEventListener('DOMContentLoaded', ()=>{
    const tagBtns = document.querySelectorAll('.tag-btn');
    tagBtns.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        tagBtns.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const cat = btn.dataset.cat;
        document.dispatchEvent(new CustomEvent('marketCategoryChange', { detail: cat }));
      });
    });
  });
</script>
