<!doctype html>
<html lang="ук">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}{{ title or 'PXP' }}{% endblock %}</title>

  <!-- 1) Глобальні стилі (каркас без кольорів) -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <!-- 2) Додаткові базові стилі (покладаються на змінні теми) -->
  <style>
    :root{
      --bg:#0f1115;
      --ink:#e8eaed;
      --line:#1b2131;
      --card:#11141b;
      --muted:#9fb0d4;
      --btn:#1a73e8;
      --nav-bg:#0b0d12;
      --link:#8ab4ff;
    }

    body{
      margin:0;
      background:var(--bg);
      color:var(--ink);
      font-family:system-ui,Segoe UI,Roboto,Arial;
    }
    main{max-width:1100px;margin:16px auto;padding:0 20px}
    a{color:var(--link);text-decoration:none}
    a:hover{text-decoration:underline}

    /* flash */
    .flash{margin:10px 0}
    .flash .item{
      background:color-mix(in srgb, var(--card) 88%, #1f2b45 12%);
      border:1px solid color-mix(in srgb, var(--line) 85%, #2a3b63 15%);
      color:color-mix(in srgb, var(--ink) 85%, #dbe5ff 15%);
      padding:10px;border-radius:10px;margin-bottom:8px
    }
  </style>

  <!-- 3) ТЕМА (МАЄ ЙТИ ПІСЛЯ КАРКАСА ТА INLINE-СТИЛЕЙ, щоб переважати кольорами) -->
  <link id="theme-css" rel="stylesheet" href="{{ url_for('static', filename='themes/main.css') }}">
  <script>
    (function(){
      var saved = localStorage.getItem('theme') || 'main';
      var map = {
        main: '{{ url_for("static", filename="themes/main.css") }}',
        cat: '{{ url_for("static", filename="themes/cat.css") }}',
        hellowen: '{{ url_for("static", filename="themes/hellowen.css") }}',
        minecraft: '{{ url_for("static", filename="themes/minecraft.css") }}'
      };
      var el = document.getElementById('theme-css');
      if (el) el.href = map[saved] || map.main;
      document.documentElement.setAttribute('data-theme', saved);
    })();
  </script>

  {% block extra_head %}{% endblock %}
</head>
<body>
  {% include 'nav.html' %}

  <main>
    {% with msgs = get_flashed_messages() %}
      {% if msgs %}
        <div class="flash">
          {% for m in msgs %}<div class="item">{{ m }}</div>{% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </main>

  {% block scripts %}{% endblock %}

  {# ЧАТ БІЛЬШЕ НЕ ВСТАВЛЯЄМО ТУТ.
     Він уже підключається в nav.html як {% include "chat.html" %} з умовою:
     not in ["auth.login","auth.register","auth.logout"] #}

</body>
</html>
